# 要件定義書: 一人暮らし向け料理提案アプリ（MVP）

- 文書ID: REQ-SOLO-RECIPE
- 文書バージョン: 2.1
- 改訂日: 2026-02-19
- 正本: 本書（要件）
- 関連文書:
  - 技術要件: `doc/technical-requirements.md`
  - 受入試験仕様: `doc/acceptance-test-spec.md`

## 1. 背景と目的
一人暮らしユーザーの夕食準備における意思決定負荷を下げ、食費を抑えることを目的とする。  
本アプリは、在庫・予算・調理時間に基づいて夕食レシピを提案し、調理実行と月次集計までを支援する。

### 1.1 プロダクト目的
- 夕食メニュー決定時間の短縮
- 自炊実行率の向上
- 月間食費の削減

### 1.2 成功指標（MVP最重要KPI）
- KPI名: 食費削減額（月次）
- 算出式: `自己申告の自炊前月平均食費 - 当月実績食費`
- 判定単位: カレンダー月

## 2. スコープ
### 2.1 In Scope
- 夕食レシピ提案（固定レシピDB）
- 食材在庫管理（手入力 + 候補補完）
- 1食推定コスト算出（単価入力ベース）
- 不足食材の買い物リスト化
- 調理実行ログ
- 月次食費実績と削減額表示
- ローカル保存（ログインなし）
- PWA対応（ホーム画面追加、基本的なオフライン閲覧）

### 2.2 Out of Scope
- 食事制限対応（アレルギー、宗教、主義）
- 外部価格API連携
- 認証、クラウド同期
- プッシュ通知
- 課金、広告
- 朝食・昼食提案
- アクセシビリティ対応（スクリーンリーダー等）

## 3. 想定ユーザー
- 一人暮らしの社会人・学生
- 献立決定に時間を使いたくないユーザー
- 食費を抑えたいユーザー

## 4. 機能要件（FR）
優先度定義:
- Must: MVP必須
- Should: MVPで実装を目指す

| ID | 優先 | 要件 | 技術詳細参照 |
|---|---|---|---|
| FR-001 | Must | 初回起動時に基準月額食費を入力・保存できる。初回判定は `setupCompleted` が未存在の場合とする。 | TR-DB-004 |
| FR-002 | Must | 初期1食予算は400円とし、ユーザーが変更できる。 | TR-DATA-001 |
| FR-003 | Must | 提案対象食事は夕食固定とする。 | TR-REC-001 |
| FR-010 | Must | 食材を手入力で登録できる（名称、数量、単位、単価）。 | TR-UI-002 |
| FR-011 | Must | 食材名入力時に候補補完を提供する。 | TR-UI-002 |
| FR-012 | Must | 在庫の編集・削除ができる。 | TR-DB-001 |
| FR-013 | Should | 単価未設定食材を識別表示できる。 | TR-UI-003 |
| FR-020 | Must | 固定レシピDBから候補取得できる。初期件数50件以上、提供形式は `src/data/recipes.json` とする。 | TR-REC-002 |
| FR-021 | Must | 調理時間20分以内かつ予算内で絞り込みできる。該当0件時は「条件を満たすレシピがありません」を表示する。 | TR-REC-003 |
| FR-022 | Must | 節約優先スコアで候補を並び替える。 | TR-REC-004 |
| FR-023 | Must | レシピ詳細（材料、手順、推定コスト）を表示する。 | TR-UI-004 |
| FR-030 | Must | 選択レシピの不足食材を抽出できる。 | TR-LOGIC-001 |
| FR-031 | Must | 不足食材を買い物リストに追加・削除できる。 | TR-DB-001 |
| FR-032 | Should | 買い物済みチェック状態を保持できる。 | TR-DB-001 |
| FR-040 | Must | 調理完了時に実コストを記録できる。 | TR-DB-001 |
| FR-041 | Must | 調理完了と同時に在庫を自動差し引きする。負値は0にクランプし通知する。差し引きは手動キャンセル不可とする。 | TR-LOGIC-002 |
| FR-041a | Must | 調理ログを削除できる。削除後も在庫数量は変動しない（ロールバック不可）。 | TR-DB-001 |
| FR-042 | Must | 月次実績食費を自動集計する。集計期間はカレンダー月（1日〜末日）とし、過去月データを保持する。 | TR-AGG-001 |
| FR-043 | Must | 基準月額食費との差分で削減額を表示する。表示月は切り替え可能とする。 | TR-AGG-002 |
| FR-044 | Should | 日別・週別の簡易推移を表示できる。 | TR-AGG-003 |
| FR-050 | Must | 全データをブラウザローカル（IndexedDB等）に保存する。 | TR-DB-001 |
| FR-051 | Must | ページ再訪時に保存データを復元する。 | TR-DB-002 |
| FR-052 | Must | 設定画面から明示操作で初期化できる。実行前に確認ダイアログを必須とする。 | TR-DB-005 |
| FR-053 | Must | IndexedDB初期化・読み書き失敗時にエラーメッセージを表示し、対象操作を中断する。 | TR-DB-006 |

## 5. 非機能要件（NFR）
| ID | 要件 |
|---|---|
| NFR-001 | 提案一覧表示まで2秒以内（レシピ200件規模、一般的スマホ環境）。 |
| NFR-002 | 主要スマホブラウザ最新2世代で動作する。 |
| NFR-003 | 日本語UIを提供する。 |
| NFR-004 | 個人情報を収集しない（認証なし、ローカル完結）。 |
| NFR-005 | オフライン時も保存済みデータを閲覧可能。 |

## 6. 画面要件（MVP）
- 画面A: 初期設定（基準月額食費、1食予算）
- 画面B: 在庫一覧・編集
- 画面C: レシピ提案一覧
- 画面D: レシピ詳細
- 画面E: 買い物リスト
- 画面F: 月次ダッシュボード

## 7. 制約条件
- 外部APIに依存しない。
- バックエンドなしのクライアント中心構成とする。
- 初期データは固定レシピDBを同梱する。

## 8. リスクと対応方針
- 単価未登録が多い場合の精度低下:
  - 対応: 単価未設定の可視化と入力促進導線を提供する。
- ローカル保存のみで端末変更時にデータ喪失:
  - 対応: MVPでは許容し、将来の同期機能で対応する。
- 固定レシピ件数不足による提案の単調化:
  - 対応: MVP後のレシピ拡充運用を前提とする。

## 9. 将来拡張
- 食事制限対応
- 朝食/昼食・作り置き対応
- 通知（献立提案・期限リマインド）
- 認証・クラウド同期
- 外部価格API連携
- 収益化（広告または有料プラン）
