# 受入試験仕様書: 一人暮らし向け料理提案アプリ（MVP）

- 文書ID: AT-SOLO-RECIPE
- 文書バージョン: 1.0
- 作成日: 2026-02-19
- 関連文書:
  - 要件定義: `doc/requirements.md`
  - 技術要件: `doc/technical-requirements.md`

## 1. 目的
本書は `FR-*` および `NFR-*` の受入判定基準を `AT-*` として定義する。  
各要件は最低1件以上の `AT-*` に対応付ける。

## 2. テスト前提
- テスト対象はMVP機能に限定する。
- 日付・時刻は `Asia/Tokyo` 基準で確認する。
- 永続化はIndexedDB、初回判定はlocalStorageを利用する前提で確認する。

## 3. 受入テストケース
| AT-ID | 種別 | 対象要件 | シナリオ概要 | 期待結果 |
|---|---|---|---|---|
| AT-001 | 機能 | FR-001 | `setupCompleted` が未設定の状態で初回起動する。 | 初期設定画面が表示され、基準月額食費を保存できる。 |
| AT-002 | 機能 | FR-001, FR-002 | 初回設定完了後に再起動する。 | 初期設定をスキップし、保存済み予算/基準値が復元される。 |
| AT-003 | 機能 | FR-003 | 提案条件を表示する。 | mealType が夕食固定で変更不可。 |
| AT-004 | 機能 | FR-010 | 食材を名称/数量/単位/単価で登録する。 | 在庫一覧に登録データが反映される。 |
| AT-005 | 機能 | FR-011 | 食材名入力で候補補完を利用する。 | 候補一覧が表示され選択反映できる。 |
| AT-006 | 機能 | FR-012 | 在庫項目を編集/削除する。 | 編集内容が反映され、削除項目が消える。 |
| AT-007 | 機能 | FR-013 | 単価未設定の在庫を表示する。 | 単価未設定状態が識別表示される。 |
| AT-008 | 機能 | FR-020 | レシピデータを読込む。 | `src/data/recipes.json` 由来データが読み込まれ、件数50以上。 |
| AT-009 | 機能 | FR-021 | 条件を厳しくして提案0件にする。 | 「条件を満たすレシピがありません」が表示される。 |
| AT-010 | 機能 | FR-021, FR-022 | 提案一覧を表示する。 | 20分以内・予算内に絞り込まれ、節約優先スコア順になる。 |
| AT-011 | 機能 | FR-023 | 提案から詳細へ遷移する。 | 材料、手順、推定コストが表示される。 |
| AT-012 | 機能 | FR-030 | 在庫不足状態でレシピを選択する。 | 不足食材のみ抽出される。 |
| AT-013 | 機能 | FR-031 | 不足食材を買い物リストへ追加/削除する。 | 追加・削除が正しく反映される。 |
| AT-014 | 機能 | FR-032 | 買い物済みをチェックし再表示する。 | チェック状態が保持される。 |
| AT-015 | 機能 | FR-040 | 調理完了時に実コストを記録する。 | 調理ログが作成される。 |
| AT-016 | 機能 | FR-041 | 在庫不足気味の状態で調理完了する。 | 在庫が自動差し引きされ、負値は0クランプされ通知される。 |
| AT-017 | 機能 | FR-041a | 調理ログを削除する。 | ログが削除され、在庫数量は元に戻らない（ロールバック不可）。 |
| AT-018 | 機能 | FR-042 | 月跨ぎデータを作成して集計する。 | 1日〜末日単位で集計され、過去月データが保持される。 |
| AT-019 | 機能 | FR-043 | 月選択UIで表示月を切り替える。 | 選択月の baseline/actual/saving が表示される。 |
| AT-020 | 機能 | FR-044 | 日別・週別推移を表示する。 | 日別グラフは当月の各日の実コストで描画され、週別グラフは当月を週単位で集計した実コストで描画される。 |
| AT-021 | 機能 | FR-050, FR-051 | データ登録後に再起動する。 | IndexedDBから復元され、登録データを再表示できる。 |
| AT-022 | 機能 | FR-052 | 設定画面からデータ初期化を実行する。 | 実行前に確認ダイアログが表示され、確認後のみ初期化される。 |
| AT-023 | 機能 | FR-053 | IndexedDB初期化/読込/書込を失敗させる。 | エラー表示後、対象操作が中断される。 |
| AT-024 | 非機能 | NFR-001 | レシピ200件相当で提案一覧を表示する。 | 表示開始まで2秒以内。 |
| AT-025 | 非機能 | NFR-002 | 主要スマホブラウザ2世代で主要導線を実行する。 | 重大不具合なく動作する。 |
| AT-026 | 非機能 | NFR-003 | 主要画面文言を確認する。 | 日本語UIで統一される。 |
| AT-027 | 非機能 | NFR-004 | 送信データと機能を確認する。 | 認証機能・個人情報収集が存在しない。 |
| AT-028 | 非機能 | NFR-005 | 一度読込後にオフライン状態へ切り替える。 | 保存済みデータを閲覧できる。 |

## 4. FR-AT対応表（全FR）
| FR-ID | 対応AT-ID |
|---|---|
| FR-001 | AT-001, AT-002 |
| FR-002 | AT-002 |
| FR-003 | AT-003 |
| FR-010 | AT-004 |
| FR-011 | AT-005 |
| FR-012 | AT-006 |
| FR-013 | AT-007 |
| FR-020 | AT-008 |
| FR-021 | AT-009, AT-010 |
| FR-022 | AT-010 |
| FR-023 | AT-011 |
| FR-030 | AT-012 |
| FR-031 | AT-013 |
| FR-032 | AT-014 |
| FR-040 | AT-015 |
| FR-041 | AT-016 |
| FR-041a | AT-017 |
| FR-042 | AT-018 |
| FR-043 | AT-019 |
| FR-044 | AT-020 |
| FR-050 | AT-021 |
| FR-051 | AT-021 |
| FR-052 | AT-022 |
| FR-053 | AT-023 |

## 5. NFR-AT対応表（全NFR）
| NFR-ID | 対応AT-ID |
|---|---|
| NFR-001 | AT-024 |
| NFR-002 | AT-025 |
| NFR-003 | AT-026 |
| NFR-004 | AT-027 |
| NFR-005 | AT-028 |

## 6. 必須シナリオ確認チェック
| 必須シナリオ | 対応AT-ID |
|---|---|
| 初回判定（setupCompleted） | AT-001, AT-002 |
| 提案0件時メッセージ | AT-009 |
| 在庫自動差し引きクランプ | AT-016 |
| 月次表示切り替え | AT-019 |
| 初期化確認ダイアログ | AT-022 |
| IndexedDB障害時中断 | AT-023 |
| オフライン閲覧 | AT-028 |

## 7. 受入完了条件
- 全Must要件に紐づくATが成功すること。
- Should要件のATについては結果を記録し、未達時はリリース判定会で扱いを決定すること。
- `FR-AT` および `NFR-AT` 対応表に未対応IDがないこと。
